# ç®€ä»‹
Jetpack Composeæ˜¯ä¸€ç§ç”¨äºæ„å»ºUIçš„å·¥å…·ï¼ŒåŸºäºå“åº”å¼ç¼–ç¨‹æ¨¡å‹ä¸Kotlinå‡½æ•°å¼è¯­æ³•ï¼Œé€šè¿‡Skiaå›¾å½¢å¼•æ“ç›´æ¥ç»˜åˆ¶å›¾åƒï¼Œç›¸æ¯”ä¼ ç»Ÿçš„Viewä½“ç³»è¯­æ³•æ›´åŠ ç®€æ´ã€æ‰§è¡Œæ•ˆç‡æ›´é«˜ã€‚

åœ¨Viewä½“ç³»ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç›‘å¬äº‹ä»¶ï¼ˆä¾‹å¦‚ï¼šå›è°ƒæ–¹æ³•ï¼‰ï¼Œå¹¶åœ¨äº‹ä»¶å‘ç”Ÿæ—¶æ§åˆ¶å…³è”çš„UIç»„ä»¶ä½œå‡ºå˜åŒ–ï¼›è€Œåœ¨Composeä½“ç³»ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡Composeå‡½æ•°æè¿°ç»„ä»¶çš„æ ·å¼ï¼Œæ¯å½“çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒComposeè¿è¡Œç¯å¢ƒä¼šè‡ªåŠ¨è°ƒç”¨å—å½±å“ç»„ä»¶çš„å£°æ˜å‡½æ•°ï¼Œä¼ å…¥æ–°çš„å‚æ•°ä»¥åˆ·æ–°æ˜¾ç¤ºã€‚

æœ¬ç« çš„ç›¸å…³çŸ¥è¯†è¯¦è§ä»¥ä¸‹é“¾æ¥ï¼š

- [ğŸ”— Androidå®˜æ–¹æ–‡æ¡£ - Jetpack Compose](https://developer.android.com/develop/ui/compose/documentation)
- [ğŸ”— Androidå®˜æ–¹ç¤ºä¾‹ - Jetpack Compose](https://developer.android.com/courses/pathways/compose)

æœ¬ç« çš„ç¤ºä¾‹å·¥ç¨‹è¯¦è§ä»¥ä¸‹é“¾æ¥ï¼š

- [ğŸ”— ç¤ºä¾‹å·¥ç¨‹ï¼šæ¦‚è¿°](https://github.com/BI4VMR/Study-Android/tree/master/M03_UI/C10_Compose/S01_Base)


# åŸºæœ¬åº”ç”¨
ä¸‹æ–‡ç¤ºä¾‹å±•ç¤ºäº†Jetpack Composeçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ã€‚

ğŸ”´ ç¤ºä¾‹ä¸€ï¼šæ„å»ºJetpack Composeç¯å¢ƒã€‚

åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸ºå·¥ç¨‹æ·»åŠ Jetpack Composeçš„ç›¸å…³é…ç½®ï¼Œå¹¶åˆ›å»ºåŸºæœ¬çš„UIç»„ä»¶ã€‚

ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬åœ¨æ¨¡å—çš„Gradleé…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¯¹Jetpack Composeç»„ä»¶çš„ä¾èµ–å£°æ˜ã€‚

"build.gradle":

```groovy
dependencies {
    // Jetpack Compose BOMç‰ˆæœ¬é…ç½®
    implementation platform('androidx.compose:compose-bom:2023.06.01')

    // Jetpack Compose æ ¸å¿ƒç»„ä»¶
    implementation 'androidx.compose.ui:ui'
    implementation 'androidx.compose.ui:ui-graphics'
    implementation 'androidx.compose.material3:material3'
    implementation 'androidx.activity:activity-compose:1.6.1'
    // Jetpack Compose è°ƒè¯•å·¥å…·
    implementation 'androidx.compose.ui:ui-tooling'
    implementation 'androidx.compose.ui:ui-tooling-preview'

    // Jetpack Compose æµ‹è¯•å·¥å…·
    androidTestImplementation(platform('androidx.compose:compose-bom:2023.06.01'))
    androidTestImplementation 'androidx.compose.ui:ui-test-junit4'
    androidTestImplementation 'androidx.compose.ui:ui-test-manifest'
}
```

ä¸Šè¿°å†…å®¹ä¹Ÿå¯ä»¥ä½¿ç”¨Kotlinè¯­è¨€ç¼–å†™ï¼š

"build.gradle.kts":

```kotlin
dependencies {
    // Jetpack Compose BOMç‰ˆæœ¬é…ç½®
    implementation(platform("androidx.compose:compose-bom:2023.06.01"))

    // Jetpack Compose æ ¸å¿ƒç»„ä»¶
    implementation("androidx.compose.ui:ui")
    implementation("androidx.compose.ui:ui-graphics")
    implementation("androidx.compose.material3:material3")
    implementation("androidx.activity:activity-compose:1.6.1")
    // Jetpack Compose è°ƒè¯•å·¥å…·
    implementation("androidx.compose.ui:ui-tooling")
    implementation("androidx.compose.ui:ui-tooling-preview")

    // Jetpack Compose æµ‹è¯•å·¥å…·
    androidTestImplementation(platform("androidx.compose:compose-bom:2023.06.01"))
    androidTestImplementation("androidx.compose.ui:ui-test-junit4")
    androidTestImplementation("androidx.compose.ui:ui-test-manifest")
}
```

Jetpack Composeçš„ç›¸å…³ç»„ä»¶æ•°é‡ä¼—å¤šï¼Œå¦‚æœç”±å¼€å‘è€…æ‰‹åŠ¨å£°æ˜æ¯ä¸ªç»„ä»¶çš„ç‰ˆæœ¬å·ï¼Œå®¹æ˜“å‡ºç°å†²çªï¼›å› æ­¤å®˜æ–¹æä¾›äº†BOMæ–‡ä»¶ï¼Œå½“æˆ‘ä»¬å¼•å…¥è¯¥æ–‡ä»¶åï¼Œå£°æ˜å…¶ä»–ç»„ä»¶æ—¶å°±ä¸å¿…å†æŒ‡æ˜ç‰ˆæœ¬å·äº†ã€‚BOMæ–‡ä»¶ç‰ˆæœ¬ä¸Composeç»„ä»¶ç‰ˆæœ¬çš„å¯¹åº”å…³ç³»å¯å‚è€ƒç›¸å…³ç½‘é¡µï¼š [ğŸ”— Jetpack Compose BOMç‰ˆæœ¬](https://developer.android.com/develop/ui/compose/bom/bom-mapping) ã€‚

Jetpack Composeçš„æ ¸å¿ƒç»„ä»¶æ˜¯å¿…é€‰çš„ï¼›è°ƒè¯•å·¥å…·æ˜¯å¯é€‰çš„ï¼Œå®ƒä»¬èƒ½å¤Ÿåœ¨å¼€å‘é˜¶æ®µä¸ºå¼€å‘è€…æä¾›é¢„è§ˆç­‰åŠŸèƒ½ï¼›æµ‹è¯•å·¥å…·åˆ™æä¾›äº†å¯¹äºJUnitçš„æ”¯æŒï¼Œå¦‚æœæˆ‘ä»¬ä¸éœ€è¦ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥ä¸å£°æ˜è¿™äº›ä¾èµ–é¡¹ã€‚

ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬åœ¨æ¨¡å—çš„Gradleé…ç½®æ–‡ä»¶ä¸­æ·»åŠ Jetpack Composeçš„ç›¸å…³é…ç½®ã€‚

"build.gradle":

```groovy
android {
    buildFeatures {
        // å¼€å¯Compose
        compose = true
    }

    composeOptions {
        // Jetpack Composeæ³¨è§£å¤„ç†å™¨ç‰ˆæœ¬
        kotlinCompilerExtensionVersion = '1.5.7'
    }
}
```

ä¸Šè¿°å†…å®¹ä¹Ÿå¯ä»¥ä½¿ç”¨Kotlinè¯­è¨€ç¼–å†™ï¼š

"build.gradle.kts":

```kotlin
android {
    buildFeatures {
        // å¼€å¯Compose
        compose = true
    }

    composeOptions {
        // Jetpack Composeæ³¨è§£å¤„ç†å™¨ç‰ˆæœ¬
        kotlinCompilerExtensionVersion = "1.5.7"
    }
}
```

æˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨ `buildFeatures {}` å°èŠ‚ä¸­å¼€å¯Gradleå¯¹Jetpack Composeçš„ç¼–è¯‘åŠŸèƒ½ï¼Œç„¶ååœ¨ `composeOptions {}` å°èŠ‚ä¸­æŒ‡æ˜æ³¨è§£å¤„ç†å™¨çš„ç‰ˆæœ¬å·ã€‚æ³¨è§£å¤„ç†å™¨çš„ç‰ˆæœ¬éœ€è¦ä¸å½“å‰æ¨¡å—çš„Kotlinç‰ˆæœ¬ç›¸åŒ¹é…ï¼Œå¯¹åº”å…³ç³»å¯åœ¨ [ğŸ”— Composeæ³¨è§£å¤„ç†å™¨ç‰ˆæœ¬](https://developer.android.com/jetpack/androidx/releases/compose-kotlin#pre-release_kotlin_compatibility) ç½‘é¡µä¸­æŸ¥è¯¢ã€‚

ç¬¬ä¸‰æ­¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªActivityï¼Œå£°æ˜ä¸€äº›Composeç»„ä»¶ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºActivityçš„æ˜¾ç¤ºå†…å®¹ã€‚

"TestUIBase.kt":

```kotlin
class TestUIBase : ComponentActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        // æ˜¾ç¤ºCompose UIç»„ä»¶
        setContent {
            // åº”ç”¨ä¸»é¢˜
            TestComposeTheme {
                // åº”ç”¨å¸ƒå±€
                Scaffold(modifier = Modifier.fillMaxSize()) { innerPadding ->
                    // æ”¾ç½®æ§ä»¶
                    Greeting(
                        name = "Android",
                        modifier = Modifier.padding(innerPadding)
                    )
                }
            }
        }
    }

    // å£°æ˜Composeç»„ä»¶
    @Composable
    fun Greeting(name: String, modifier: Modifier = Modifier) {
        // å£°æ˜æ–‡æœ¬æ¡†
        Text(
            text = "Hello $name!",
            modifier = modifier
        )
    }

    // å£°æ˜Composeç»„ä»¶é¢„è§ˆ
    @Preview(showBackground = true)
    @Composable
    fun GreetingPreview() {
        TestComposeTheme {
            Greeting("Android")
        }
    }
}
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ `Greeting()` æ–¹æ³•è¢« `@Composable` æ³¨è§£ä¿®é¥°ï¼Œå› æ­¤è¿™æ˜¯ä¸€ä¸ªComposeç»„ä»¶ï¼›å…¶ä¸­çš„ `Text()` æ–¹æ³•å£°æ˜äº†ä¸€ä¸ªæ–‡æœ¬æ¡†ï¼Œéƒ¨åˆ†å†…å®¹ç”± `Greeting()` æ–¹æ³•çš„ç¬¬ä¸€å‚æ•° `name` å†³å®šï¼Œä»¥æé«˜ç»„ä»¶çš„åŠ¨æ€æ€§ã€‚

`GreetingPreview()` æ–¹æ³•è¢« `@Preview` æ³¨è§£ä¿®é¥°ï¼Œåœ¨å¼€å‘é˜¶æ®µAndroid Studioèƒ½å¤Ÿæä¾›ç»„ä»¶å¤–è§‚é¢„è§ˆï¼Œåœ¨è¿è¡Œé˜¶æ®µåˆ™æ— ä½œç”¨ã€‚

åœ¨Activityçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³• `onCreate()` ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ `setContent()` æ–¹æ³•è®¾ç½®ç•Œé¢å†…å®¹ï¼›æœ€å¤–å±‚çš„TestComposeThemeæ˜¯ä¸»é¢˜ã€è¾ƒå†…å±‚çš„Scaffoldæ˜¯å¸ƒå±€ã€æœ€å†…å±‚çš„Greetingå³ä¸ºComposeç»„ä»¶ã€‚


# ç–‘éš¾è§£ç­”
## ç´¢å¼•

<div align="center">

|       åºå·        |                          æ‘˜è¦                          |
| :---------------: | :----------------------------------------------------: |
| [æ¡ˆä¾‹ä¸€](#æ¡ˆä¾‹ä¸€) | ç¼–è¯‘å¤±è´¥ï¼Œé”™è¯¯æ¶ˆæ¯ä¸ºï¼šéƒ¨åˆ†ç»„ä»¶ä»…æ”¯æŒAPI 34åŠæ›´é«˜ç‰ˆæœ¬ã€‚ |

</div>

## æ¡ˆä¾‹ä¸€
### é—®é¢˜æè¿°
APPæ¨¡å—ç¼–è¯‘å¤±è´¥ï¼Œé”™è¯¯ä¿¡æ¯ä¸ºï¼š `<ç»„ä»¶> depend on it to compile against version 34 or later of the Android APIs` ã€‚

```text
22 issues were found when checking AAR metadata:

1.  Dependency 'androidx.compose.material3:material3-android:1.2.1' requires libraries and applications that depend on it to compile against version 34 or later of the Android APIs.

# æ­¤å¤„çœç•¥éƒ¨åˆ†è¾“å‡ºå†…å®¹...
```

### é—®é¢˜åˆ†æ
éƒ¨åˆ†ç»„ä»¶çš„è¾ƒæ–°ç‰ˆæœ¬ä¸å…¼å®¹API 33åŠæ›´ä½ç‰ˆæœ¬çš„SDKï¼Œå¦‚æœæˆ‘ä»¬æ— æ³•å‡çº§å·¥ç¨‹çš„ç¼–è¯‘SDKç‰ˆæœ¬ï¼Œåˆ™åªèƒ½ä½¿ç”¨è¿™äº›ç»„ä»¶çš„è¾ƒæ—§ç‰ˆæœ¬ã€‚

### è§£å†³æ–¹æ¡ˆ
ç›®å‰å„ä¸ªç»„ä»¶å¯¹API 33åŠæ›´é«˜ç‰ˆæœ¬çš„æ”¯æŒæƒ…å†µå°šæ— å®˜æ–¹æ–‡æ¡£å¯ä¾›æŸ¥è¯¢ï¼Œç»è¿‡æµ‹è¯•ï¼Œå½“å·¥ç¨‹çš„APIç‰ˆæœ¬ä¸º33æ—¶ï¼Œå„ä¸ªç»„ä»¶èƒ½å¤Ÿæ”¯æŒçš„æœ€é«˜ç‰ˆæœ¬å¦‚ä¸‹æ–‡åˆ—è¡¨æ‰€ç¤ºï¼š

- `androidx.compose:compose-bom` : `2023.06.01`
- `androidx.activity:activity-compose` : `1.6.1`
