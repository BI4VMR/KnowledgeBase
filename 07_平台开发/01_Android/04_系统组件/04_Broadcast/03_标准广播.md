# ç®€ä»‹
æˆ‘ä»¬é™¤äº†è¢«åŠ¨æ¥æ”¶ç³»ç»Ÿçº§çš„å¹¿æ’­æ¶ˆæ¯ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä¸»åŠ¨å‘ç³»ç»Ÿä¸­å‘é€å¹¿æ’­ï¼Œä»¥é€šçŸ¥å…¶å®ƒç»„ä»¶æŸäº›äº‹ä»¶è§¦å‘ï¼Œä»¥ä¾¿å®ƒä»¬ä½œå‡ºå“åº”ã€‚

æœ¬ç« ç¤ºä¾‹ä»£ç è¯¦è§ä»¥ä¸‹é“¾æ¥ï¼š

- [ğŸ”— ç¤ºä¾‹å·¥ç¨‹ï¼šæ ‡å‡†å¹¿æ’­](https://github.com/BI4VMR/Study-Android/tree/master/M04_System/C03_Broadcast/S02_Normal)

# åŸºæœ¬åº”ç”¨
## å‘é€å¹¿æ’­
æˆ‘ä»¬é¦–å…ˆéœ€è¦æ„é€ ä¸€ä¸ªIntentå®ä¾‹ï¼Œç„¶åè°ƒç”¨Contextçš„ `sendBroadcast(Intent intent)` æ–¹æ³•ï¼Œä¼ å…¥Intentå®ä¾‹å‘é€å¹¿æ’­ã€‚

æ­¤å¤„ä¸ºäº†æµ‹è¯•æ–¹ä¾¿ï¼Œæˆ‘ä»¬åœ¨æµ‹è¯•Activityä¸­æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œç”¨æˆ·æŒ‰ä¸‹æŒ‰é’®åå‘é€è‡ªå®šä¹‰å¹¿æ’­ã€‚

"TestUIBase.java":

```java
// å‘é€å¹¿æ’­æŒ‰é’®
btSend.setOnClickListener(v -> {
    // åˆ›å»ºIntentå®ä¾‹ï¼Œè®¾ç½®Actionï¼Œå¹¶æºå¸¦é¢å¤–çš„æ•°æ®ã€‚
    Intent intent = new Intent();
    intent.setAction("net.bi4vmr.MY_BROADCAST");
    intent.putExtra("message", "Broadcast Test.");
    // å‘é€å¹¿æ’­
    sendBroadcast(intent);
});
```

## æ¥æ”¶å¹¿æ’­
æ¥æ”¶è‡ªå®šä¹‰å¹¿æ’­çš„æ–¹å¼ä¸æ¥æ”¶ç³»ç»Ÿå¹¿æ’­æ˜¯ç›¸åŒçš„ï¼ŒåŒºåˆ«ä»…åœ¨äºæˆ‘ä»¬éœ€è¦è¿‡æ»¤çš„Actionæ˜¯å‘é€è€…å®šä¹‰çš„å­—ç¬¦ä¸²ã€‚

å¹¿æ’­æ¥æ”¶è€…å¯ä»¥æ˜¯å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œæ­¤å¤„ä¸ºäº†æµ‹è¯•æ–¹ä¾¿ï¼Œæˆ‘ä»¬ç›´æ¥å°†æ¥æ”¶å™¨æ³¨å†Œé€»è¾‘å†™åœ¨æµ‹è¯•Activityä¸­ã€‚æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªBroadcastReceiverç±»çš„å­ç±»MyReceiverï¼Œæ”¶åˆ°æ¶ˆæ¯åå–å‡ºåä¸º"message"çš„é¢å¤–æ•°æ®ï¼Œå¹¶æ˜¾ç¤ºåˆ°æ§åˆ¶å°ä¸Šã€‚

"TestUIBase.java":

```java
private class MyReceiver extends BroadcastReceiver {

   @Override
    public void onReceive(Context context, Intent intent) {
        String action = intent.getAction();
        String msg = intent.getStringExtra("message");
        // æ¥æ”¶åˆ°å¹¿æ’­æ—¶ï¼Œéœ€è¦æ‰§è¡Œçš„æ“ä½œã€‚
        Log.i(TAG, "MyReceiver-OnReceive. Action:" + action + "ï¼Œæºå¸¦æ•°æ®ï¼š" + msg);
    }
}
```

ç„¶åæˆ‘ä»¬åœ¨æµ‹è¯•Activityä¸­æ³¨å†Œå¹¿æ’­æ¥æ”¶å™¨ï¼Œæ¥æ”¶Actionä¸º"net.bi4vmr.MY_BROADCAST"çš„å¹¿æ’­æ¶ˆæ¯ã€‚

```java
// åˆ›å»ºè¿‡æ»¤å™¨ï¼Œå¡«å†™è¦æ¥æ”¶çš„å¹¿æ’­ç±»å‹ã€‚
IntentFilter filter = new IntentFilter();
filter.addAction("net.bi4vmr.MY_BROADCAST");
// åˆ›å»ºæ¥æ”¶å™¨å®ä¾‹ï¼Œå¹¶è¿›è¡ŒåŠ¨æ€æ³¨å†Œã€‚
MyReceiver receiver = new MyReceiver();
registerReceiver(receiver, filter);
```

è‡³æ­¤å¹¿æ’­æ¥æ”¶é€»è¾‘å·²ç»å®Œæˆï¼Œè¿è¡Œç¤ºä¾‹ç¨‹åºåï¼Œæˆ‘ä»¬æ³¨å†Œæ¥æ”¶å™¨å¹¶å‘é€è‡ªå®šä¹‰å¹¿æ’­ï¼Œç„¶åè§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºçš„æ¶ˆæ¯ï¼Œæ­¤æ—¶åº”ç”¨ç¨‹åºèƒ½å¤Ÿæ¥æ”¶åˆ°è‡ªå®šä¹‰å¹¿æ’­ï¼Œå¹¶èƒ½å–å¾—å…¶æºå¸¦çš„æ•°æ®ã€‚

```text
17:14:01.853 10619 10619 I TestApp-TestUIBase: MyReceiver-OnReceive. Action:net.bi4vmr.MY_BROADCASTï¼Œæºå¸¦æ•°æ®ï¼šBroadcast Test.
```
