# ç–‘éš¾è§£ç­”
## ç´¢å¼•

<div align="center">

|       åºå·        |                                æ‘˜è¦                                |
| :---------------: | :----------------------------------------------------------------: |
| [æ¡ˆä¾‹ä¸€](#æ¡ˆä¾‹ä¸€) | æ„å»ºå·¥ç¨‹æ—¶å‡ºç°é”™è¯¯ï¼š `does not export <ç±»å> to unnamed module` ã€‚ |
| [æ¡ˆä¾‹äºŒ](#æ¡ˆä¾‹äºŒ) |      æ„å»ºå·¥ç¨‹æ—¶å‡ºç°é”™è¯¯ï¼š `superclass access check failed` ã€‚      |
| [æ¡ˆä¾‹ä¸‰](#æ¡ˆä¾‹ä¸‰) |     æ„å»ºè„šæœ¬å¼•ç”¨Java APIæ—¶å‡ºç°é”™è¯¯ï¼š `Unresolved reference` ã€‚     |

</div>

## æ¡ˆä¾‹ä¸€
### é—®é¢˜æè¿°
æ„å»ºå·¥ç¨‹æ—¶å‡ºç°é”™è¯¯ï¼Œé”™è¯¯ä¿¡æ¯ä¸ºï¼š `does not export <ç±»å> to unnamed module` :

```text
FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':app:compileDebugJavaWithJavac'.
> java.lang.IllegalAccessError: class org.gradle.internal.compiler.java.ClassNameCollector (in unnamed module @0x49be30c6) cannot access class com.sun.tools.javac.code.Symbol$TypeSymbol (in module jdk.compiler) because module jdk.compiler does not export com.sun.tools.javac.code to unnamed module @0x49be30c6
```

### é—®é¢˜åˆ†æ
ç»æ’æŸ¥å‘ç°ï¼Œç³»ç»Ÿé»˜è®¤çš„JDKç‰ˆæœ¬ä¸º `17` ï¼Œé«˜äºGradleæ”¯æŒçš„æœ€é«˜JDKç‰ˆæœ¬ `11` ï¼Œå› æ­¤Gradleå‡ºç°äº†å†…éƒ¨é”™è¯¯ï¼Œä¸å·¥ç¨‹ä¸­çš„ä¸šåŠ¡ä»£ç æ— å…³ã€‚

### è§£å†³æ–¹æ¡ˆ
å½“å‰å·¥ç¨‹çš„Gradleç‰ˆæœ¬è¾ƒä½ï¼Œç›´æ¥ä¿®æ”¹å…¨å±€JDKç‰ˆæœ¬å¹¶ä¸åˆé€‚ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä»¥ä¸‹æ–¹æ³•ï¼Œä»…å½“å‰å·¥ç¨‹ä½¿ç”¨è¾ƒä½ç‰ˆæœ¬çš„JDKï¼š

ğŸ”· ä¿®æ”¹å·¥ç¨‹çš„Gradleé…ç½®æ–‡ä»¶

å‘å½“å‰å·¥ç¨‹çš„ `gradle.properties` é…ç½®æ–‡ä»¶æ’å…¥ä»¥ä¸‹å†…å®¹ï¼š

```ini
# æŒ‡å®šJDKè·¯å¾„
org.gradle.java.home=<ç›®æ ‡JDKè·¯å¾„>

# ç¤ºä¾‹
org.gradle.java.home=/opt/jdk_v11
```

ğŸ”· ä¿®æ”¹ç¯å¢ƒå˜é‡

å‰æ–‡æ–¹æ¡ˆéœ€è¦å°†æœ¬åœ°JDKè·¯å¾„å†™å…¥å·¥ç¨‹çš„é…ç½®æ–‡ä»¶ï¼Œä½†è¯¥æ–‡ä»¶é€šå¸¸ä¼šè¢«Gitæäº¤è‡³æœåŠ¡å™¨ï¼Œæœ‰æ—¶å¹¶ä¸åˆé€‚ã€‚

æˆ‘ä»¬è¿˜å¯ä»¥åœ¨ç»ˆç«¯ä¼šè¯æˆ–ç¼–è¯‘è„šæœ¬ä¸­ä¸´æ—¶ä¿®æ”¹ `JAVA_HOME` ç¯å¢ƒå˜é‡çš„å€¼ï¼Œè¿™ç§æ–¹å¼ä»…å½±å“å½“å‰ä¼šè¯ï¼Œä¸ä¼šå¹²æ‰°å…¨å±€ç¯å¢ƒå˜é‡ã€‚

```text
# ä¿®æ”¹å½“å‰Shellä¼šè¯çš„"JAVA_HOME"å˜é‡å€¼
[bi4vmr@Fedora Project]$ JAVA_HOME=/opt/jdk_v11

# æœ¬ä¼šè¯ä¸­çš„Gradleä»»åŠ¡å°†ä¼šä½¿ç”¨å¯¹åº”çš„JDKç‰ˆæœ¬
[bi4vmr@Fedora Project]$ ./gradlew build
```

## æ¡ˆä¾‹äºŒ
### é—®é¢˜æè¿°
æ„å»ºå·¥ç¨‹æ—¶å‡ºç°é”™è¯¯ï¼Œé”™è¯¯ä¿¡æ¯ä¸ºï¼š `superclass access check failed` :

```text
e: java.lang.IllegalAccessError: superclass access check failed: class org.jetbrains.kotlin.kapt3.base.javac.KaptJavaCompiler (in unnamed module @0x270d2106) cannot access class com.sun.tools.javac.main.JavaCompiler (in module jdk.compiler) because module jdk.compiler does not export com.sun.tools.javac.main to unnamed module @0x270d2106
```

### é—®é¢˜åˆ†æ
ç»æ’æŸ¥å‘ç°ï¼ŒGradleç¼–è¯‘ç¼“å­˜å‡ºç°äº†é”™è¯¯ï¼Œä¸å·¥ç¨‹ä¸­çš„ä¸šåŠ¡ä»£ç æ— å…³ã€‚

### è§£å†³æ–¹æ¡ˆ
åœæ­¢æ‰€æœ‰Gradleè¿›ç¨‹ï¼Œå¹¶æ¸…é™¤ä»¥ä¸‹ç›®å½•ä¸­ä¸å½“å‰Gradleç‰ˆæœ¬å·åŒåçš„ç›®å½•ï¼š

- `~/.gradle/daemon/`
- `~/.gradle/caches/`

## æ¡ˆä¾‹ä¸‰
### é—®é¢˜æè¿°
åœ¨æ„å»ºè„šæœ¬ä¸­å¼•ç”¨Java APIæ—¶ï¼Œå‡ºç°é”™è¯¯ï¼š `Unresolved reference` ã€‚

"settings.gradle.kts":

```kotlin
import java.net.InetAddress

pluginManagement {
    repositories {
        if (InetAddress.getByName("192.168.128.1").isReachable(2000)) {
            println("Current host is in private network, add PRIVATE repositorys.")
            maven {
                isAllowInsecureProtocol = true
                setUrl("http://192.168.128.1:8081/repository/maven-private/")
            }
        } else {
            println("Current host is not in private network, add LOCAL repositorys.")
            mavenLocal()
        }
    }
}
```

ä¸Šè¿°ä»£ç çš„ç›®çš„æ˜¯åœ¨é…ç½®æ’ä»¶ä»“åº“é˜¶æ®µï¼Œè°ƒç”¨Javaçš„InetAddressç±»æ£€æµ‹å†…ç½‘æœåŠ¡å™¨æ˜¯å¦å¯è¾¾ï¼Œå¹¶æ ¹æ®ç»“æœé€‰æ‹©è¦ä½¿ç”¨çš„ä»“åº“ã€‚

å½“æˆ‘ä»¬æ‰§è¡Œç¼–è¯‘åï¼Œå‡ºç°äº†ä»¥ä¸‹é”™è¯¯ï¼š

```text
e: file:///C:/Project/RootProject/build.gradle.kts:5:10: Unresolved reference: InetAddress
```

### é—®é¢˜åˆ†æ
é¡¶å±‚ `settings.gradle` é…ç½®æ–‡ä»¶çš„ `pluginManagement {}` å°èŠ‚ä¸æ‰€æœ‰ `build.gradle` é…ç½®æ–‡ä»¶çš„ `plugins {}` å°èŠ‚æ¯”è¾ƒç‰¹æ®Šï¼Œæ­¤å¤„ä¸èƒ½è¯†åˆ«æ–‡ä»¶é¦–éƒ¨å£°æ˜çš„ `import` è¯­å¥ã€‚

### è§£å†³æ–¹æ¡ˆ
æˆ‘ä»¬éœ€è¦ä½¿ç”¨å®Œæ•´å†™æ³•å¼•ç”¨Java APIã€‚

"settings.gradle.kts":

```kotlin
pluginManagement {
    repositories {
        if (java.net.InetAddress.getByName("192.168.128.1").isReachable(2000)) {
            println("Current host is in private network, add PRIVATE repositorys.")
            maven {
                isAllowInsecureProtocol = true
                setUrl("http://192.168.128.1:8081/repository/maven-private/")
            }
        } else {
            println("Current host is not in private network, add LOCAL repositorys.")
            mavenLocal()
        }
    }
}
```
