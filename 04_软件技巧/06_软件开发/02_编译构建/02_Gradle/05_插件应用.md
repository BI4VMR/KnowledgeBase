# å£°æ˜æ’ä»¶
Gradleæ’ä»¶åˆ†ä¸ºå†…ç½®æ’ä»¶ä¸ç¤¾åŒºæ’ä»¶ï¼Œå†…ç½®æ’ä»¶IDä»¥ `org.gradle` å¼€å¤´ï¼Œä¾‹å¦‚ï¼š `org.gradle.java-library` ã€‚æˆ‘ä»¬å£°æ˜å†…ç½®æ’ä»¶æ—¶ä¸èƒ½æŒ‡å®šç‰ˆæœ¬ï¼Œå› ä¸ºå…¶ç‰ˆæœ¬è·Ÿéšå½“å‰å·¥ç¨‹æ‰€ä½¿ç”¨çš„Gradleç‰ˆæœ¬ï¼›å¹¶ä¸”ä¸å¿…åœ¨é¡¶çº§é…ç½®æ–‡ä»¶ä¸­å£°æ˜æ’ä»¶ï¼Œç”±å„ä¸ªå­æ¨¡å—è‡ªè¡Œå£°æ˜å³å¯ã€‚

ç¤¾åŒºæ’ä»¶ç”±ç¬¬ä¸‰æ–¹å¼€å‘ï¼Œé€šå¸¸ä¼šæäº¤åˆ°Gradleç¤¾åŒºæ’ä»¶ä»“åº“ï¼Œç›¸å…³ä¿¡æ¯å¯ä»¥åœ¨ [ğŸ”— Gradle - ç¤¾åŒºæ’ä»¶ä»“åº“](https://plugins.gradle.org/) ç½‘ç«™æŸ¥è¯¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ç¤¾åŒºæ’ä»¶æ—¶å¿…é¡»å…ˆåœ¨é¡¶çº§é…ç½®æ–‡ä»¶ä¸­å£°æ˜æ’ä»¶IDä¸ç‰ˆæœ¬ï¼Œç„¶ååœ¨éœ€è¦åº”ç”¨æ’ä»¶çš„å­æ¨¡å—é…ç½®æ–‡ä»¶ä¸­å†æ¬¡å£°æ˜æ’ä»¶ã€‚

è‹¥è¦ä¸ºæ¨¡å—åº”ç”¨æ’ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å…¶ `build.gradle` é…ç½®æ–‡ä»¶çš„ `plugins {}` å°èŠ‚ä¸­è¿›è¡Œå£°æ˜ï¼Œå¸¸è§çš„æ’ä»¶å£°æ˜è¯­æ³•å¦‚ä¸‹æ–‡åˆ—è¡¨æ‰€ç¤ºï¼š

- `id("org.jetbrains.kotlin.jvm").version("1.9.25")` : è¿™æ˜¯æœ€å¸¸è§çš„æ’ä»¶å£°æ˜è¯­æ³•ï¼Œé€šè¿‡æ’ä»¶IDä¸ç‰ˆæœ¬å·è¿›è¡Œå£°æ˜ã€‚
- `` `kotlin-dsl` `` : è¿™æ˜¯å†…ç½®æ’ä»¶çš„å£°æ˜æ–¹å¼ï¼Œå®é™…ä¸Šæ˜¯å¼•ç”¨äº†Gradleæä¾›çš„åä¸º `kotlin-dsl` çš„å˜é‡ï¼Œç­‰ä»·äº `id("org.gradle.kotlin.kotlin-dsl")` ã€‚
- `kotlin("jvm")` : è¿™æ˜¯Kotlinç›¸å…³æ’ä»¶æä¾›çš„å¿«æ·è¯­æ³•ï¼Œæ‹¬å·å†…çš„å†…å®¹ä¼šè‡ªåŠ¨åŠ ä¸Š `libs.plugins.kotlin` å‰ç¼€ï¼Œç­‰ä»·äº `id("org.jetbrains.kotlin.jvm")` ã€‚
- `alias(libs.plugins.kotlin.jvm)` : å¼•ç”¨Version Catalogå®šä¹‰çš„æ’ä»¶åˆ«åä¸ç‰ˆæœ¬å·ï¼Œè¯¦è§ç›¸å…³ç« èŠ‚ [ğŸ§­ ä¾èµ–ç®¡ç† - Version Catalog](04_ä¾èµ–ç®¡ç†.md#version-catalog) ã€‚


# Maven Publish
## ç®€ä»‹
Maven Publishæ˜¯ä¸€ä¸ªGradleæ’ä»¶ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯å°†æ¨¡å—ç¼–è¯‘äº§ç”Ÿçš„JARæˆ–AARæ–‡ä»¶ä¸Šä¼ è‡³Mavenä»“åº“ï¼Œä»¥ä¾¿è¢«å…¶ä»–å·¥ç¨‹å¼•ç”¨ã€‚

Maven Publishä¸ºGradleæ–°å¢äº†ä»¥ä¸‹ä»»åŠ¡ï¼š

ğŸ”· `publish`

æ‰§è¡Œæ‰€æœ‰çš„å‘å¸ƒä»»åŠ¡ï¼Œå°†ç»„ä»¶å‘å¸ƒåˆ°è¿œç¨‹Mavenä»“åº“ã€‚

ğŸ”· `publishToMavenLocal`

æ‰§è¡Œæ‰€æœ‰çš„å‘å¸ƒä»»åŠ¡ï¼Œå°†ç»„ä»¶å‘å¸ƒåˆ°æœ¬åœ°Mavenä»“åº“ã€‚

ğŸ”· `publish<å‘å¸ƒé…ç½®åç§°>PublicationToRepoNameRepository`

æ‰§è¡ŒæŒ‡å®šçš„å‘å¸ƒä»»åŠ¡ï¼Œå°†ç»„ä»¶å‘å¸ƒåˆ°è¿œç¨‹Mavenä»“åº“ã€‚

å¦‚æœæˆ‘ä»¬åœ¨åˆ›å»ºå‘å¸ƒé…ç½®æ—¶æ²¡æœ‰æŒ‡å®šåç§°ï¼Œè¯¥åç§°é»˜è®¤ä¸º"Maven"ã€‚

ğŸ”· `publish<å‘å¸ƒé…ç½®åç§°>PublicationToMavenLocal`

æ‰§è¡ŒæŒ‡å®šçš„å‘å¸ƒä»»åŠ¡ï¼Œå°†ç»„ä»¶å‘å¸ƒåˆ°è¿œç¨‹Mavenä»“åº“ã€‚

ğŸ”· `generatePomFileFor<å‘å¸ƒé…ç½®åç§°>Publication`

ç”ŸæˆæŒ‡å®šå‘å¸ƒä»»åŠ¡å¯¹åº”çš„POMæ–‡ä»¶ï¼Œç›®æ ‡è·¯å¾„ä¸º `<æ¨¡å—æ ¹ç›®å½•>/build/publications/<å‘å¸ƒé…ç½®åç§°>/pom-default.xml` ã€‚

## åŸºæœ¬åº”ç”¨
åœ¨ä¸‹æ–‡ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸ºä¸€ä¸ªJava Libraryæ¨¡å—é…ç½®Maven Publishæ’ä»¶ï¼Œä½¿å…¶èƒ½å¤Ÿå°†ç¼–è¯‘äº§ç”Ÿçš„JARåŒ…å‘å¸ƒè‡³Mavenä»“åº“ã€‚

"build.gradle":

```groovy
plugins {
    id('java-library')
    // å¼•å…¥Maven Publishæ’ä»¶
    id('maven-publish')
}

// Maven Publishæ’ä»¶é…ç½®
publishing {
    // å‘å¸ƒç›®æ ‡ä»“åº“é…ç½®
    repositories {
        // æ·»åŠ è¿œç«¯Mavenä»“åº“
        maven {
            url = '<ä»“åº“åœ°å€>'
            credentials {
                username = '<ç”¨æˆ·åç§°>'
                password = '<ç™»å½•å£ä»¤>'
            }
        }
    }

    // å‘å¸ƒå‚æ•°é…ç½®
    publications {
        // åˆ›å»ºåä¸º"maven"çš„å‘å¸ƒé…ç½®
        maven(MavenPublication) {
            // äº§ç‰©çš„åŸºæœ¬ä¿¡æ¯
            groupId = '<Groupåç§°>'
            artifactId = '<Artifactåç§°>'
            version = '<ç‰ˆæœ¬å·>'

            // å‘å¸ƒç¨‹åºåŒ…
            from components.java

            // POMä¿¡æ¯
            pom {
                // æ‰“åŒ…æ ¼å¼
                packaging = 'jar'

                name = '<å·¥ç¨‹åç§°>'
                url = '<å·¥ç¨‹å¯¹åº”çš„ç½‘ç«™>'
            }
        }
    }
}
```

ä¸Šè¿°å†…å®¹ä¹Ÿå¯ä»¥ä½¿ç”¨Kotlinè¯­è¨€ç¼–å†™ï¼š

"build.gradle.kts":

```kotlin
plugins {
    id("java-library")
    // å¼•å…¥Maven Publishæ’ä»¶
    id("maven-publish")
}

// Maven Publishæ’ä»¶é…ç½®
publishing {
    // å‘å¸ƒç›®æ ‡ä»“åº“é…ç½®
    repositories {
        // æ·»åŠ è¿œç«¯Mavenä»“åº“
        maven {
            setUrl("<ä»“åº“åœ°å€>")
            credentials {
                username = "<ç”¨æˆ·åç§°>"
                password = "<ç™»å½•å£ä»¤>"
            }
        }

        // æ·»åŠ æœ¬åœ°Mavenä»“åº“
        mavenLocal()
    }

    // å‘å¸ƒå‚æ•°é…ç½®
    publications {
        // åˆ›å»ºåä¸º"maven"çš„å‘å¸ƒé…ç½®
        create<MavenPublication>("maven") {
            // äº§ç‰©çš„åŸºæœ¬ä¿¡æ¯
            groupId = "<Groupåç§°>"
            artifactId = "<Artifactåç§°>"
            version = "<ç‰ˆæœ¬å·>"

            // å‘å¸ƒç¨‹åºåŒ…
            from(components.getByName("java"))

            // POMä¿¡æ¯
            pom {
                // æ‰“åŒ…æ ¼å¼
                packaging = "jar"

                name.set("<å·¥ç¨‹åç§°>")
                url.set("<å·¥ç¨‹å¯¹åº”çš„ç½‘ç«™>")
            }
        }
    }
}
```

Maven Publishæ’ä»¶çš„ä¸»è¦é…ç½®é¡¹éƒ½åœ¨ `publishing {}` å°èŠ‚ä¸­ï¼Œå…¶ä¸­ `repositories {}` å°èŠ‚ç”¨äºé…ç½®ç›®æ ‡ä»“åº“ä¿¡æ¯ï¼Œè¯­æ³•ä¸ç»„ä»¶ä¾èµ–ä»“åº“é…ç½®å®Œå…¨ç›¸åŒï¼Œè¯¦è§ç›¸å…³ç« èŠ‚ï¼š [ğŸ§­ ä¾èµ–ç®¡ç† - ä»“åº“é…ç½®](./03_ä¾èµ–ç®¡ç†.md#ä»“åº“é…ç½®) ã€‚ `publications {}` å°èŠ‚ç”¨äºé…ç½®å‘å¸ƒå‚æ•°ï¼Œæ§åˆ¶éœ€è¦å‘å¸ƒçš„äº§ç‰©å’Œç”Ÿæˆçš„POMä¿¡æ¯ã€‚

æ­¤å¤„çš„ `groupId` ã€ `artifactId` ã€`version` åˆ†åˆ«ä¸ºå½“å‰æ¨¡å—çš„Groupåç§°ã€Artifactåç§°å’Œç‰ˆæœ¬å·ï¼Œå‡ä¸ºå¿…å¡«é¡¹ï¼› `from components.java` è¯­å¥æŒ‡æ˜äº†éœ€è¦å‘å¸ƒJavaä»£ç ç¼–è¯‘åäº§ç”Ÿçš„JARåŒ…ï¼› `pom {}` å°èŠ‚åˆ™å£°æ˜äº†POMä¿¡æ¯ï¼Œå…¶ä¸­ `packaging` å±æ€§è¦ä¸ç¼–è¯‘äº§ç‰©ç±»å‹ä¿æŒä¸€è‡´ï¼Œå…¶ä»–å±æ€§åˆ™å¯æ ¹æ®å®é™…éœ€è¦é€‰æ‹©æ€§åœ°å¡«å†™ã€‚

æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ `gradle publish` å‘½ä»¤ï¼ŒGradleå°†ä¼šå¼€å§‹ç¼–è¯‘ä»»åŠ¡ï¼Œå¹¶åœ¨ç¼–è¯‘æˆåŠŸåå°†äº§ç”Ÿçš„JARåŒ…ä¸Šä¼ åˆ°ç›®æ ‡ä»“åº“ä¸­ã€‚

```text
[bi4vmr@Fedora Project]# ./gradlew publish
BUILD SUCCESSFUL in 1s
12 actionable tasks: 11 executed, 1 up-to-date
```

ä¸ºäº†ç¡®ä¿å½“å‰æ¨¡å—çš„ä¾èµ–ç»„ä»¶ä¹Ÿèƒ½è¢«è°ƒç”¨è€…æ­£ç¡®è§£æï¼ŒMaven Publishæ’ä»¶ä¼šå°†ç»„ä»¶ä¿¡æ¯å†™å…¥POMæ–‡ä»¶ï¼Œæˆ‘ä»¬åº”å½“é€‰æ‹©åˆé€‚çš„ä¾èµ–æŒ‡ä»¤ï¼Œç¡®ä¿ç»„ä»¶åœ¨POMä¸­çš„Scopeå±æ€§ç¬¦åˆé¢„æœŸï¼š

<div align="center">

|  Gradleä¾èµ–æŒ‡ä»¤  |       POM Scopeå±æ€§       |
| :--------------: | :-----------------------: |
| `implementation` |         `runtime`         |
|      `api`       |         `compile`         |
|  `compileOnly`   | æ­¤ç±»ä¾èµ–é¡¹ä¸ä¼šè¢«å†™å…¥POMã€‚ |
|  `runtimeOnly`   |         `runtime`         |

</div>

é€šå¸¸æƒ…å†µä¸‹ï¼Œåº“çš„ä¾èµ–ç»„ä»¶ä¹Ÿåº”å½“èƒ½å¤Ÿè¢«è°ƒç”¨è€…è®¿é—®ï¼Œå› æ­¤æˆ‘ä»¬å»ºè®®ä½¿ç”¨ `api` å£°æ˜ä¾èµ–ç»„ä»¶ã€‚

## å‘å¸ƒæºç åŒ…
åœ¨å‰æ–‡ç¤ºä¾‹ä¸­ï¼ŒMaven Publishæ’ä»¶åªä¼šä¸Šä¼ å½“å‰æ¨¡å—çš„å­—èŠ‚ç ï¼ˆJARåŒ…ï¼‰åŠç»„ä»¶ä¾èµ–ä¿¡æ¯ï¼ˆåŒ…å«åœ¨POMæ–‡ä»¶ä¸­ï¼‰ï¼Œä½¿ç”¨è€…åœ¨IDEä¸­æ— æ³•æŸ¥çœ‹æºç ã€‚

å¦‚æœæ¨¡å—çš„ä»£ç å…è®¸å…¬å¼€ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºMaven Publishæ’ä»¶æ·»åŠ ä¸€äº›é…ç½®é¡¹ï¼Œåœ¨å‘å¸ƒç¨‹åºåŒ…çš„åŒæ—¶é™„å¸¦æºç åŒ…ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…æŸ¥çœ‹æºç ã€‚

"build.gradle":

```groovy
java {
    // ç¼–è¯‘æ¨¡å—æ—¶åŒæ—¶æ‰“åŒ…æºç 
    withSourcesJar()
}
```

ä¸Šè¿°å†…å®¹ä¹Ÿå¯ä»¥ä½¿ç”¨Kotlinè¯­è¨€ç¼–å†™ï¼š

"build.gradle.kts":

```kotlin
java {
    // ç¼–è¯‘æ¨¡å—æ—¶åŒæ—¶æ‰“åŒ…æºç 
    withSourcesJar()
}
```

å¦‚æœæˆ‘ä»¬åœ¨å‘å¸ƒé…ç½®ä¸­ä½¿ç”¨ `from components.java` è¯­å¥å‘å¸ƒç¼–è¯‘äº§ç‰©ï¼Œæ­¤æ—¶åªéœ€åœ¨ `java {}` å°èŠ‚ä¸­æŒ‡æ˜æ‰“åŒ…æºç å³å¯ï¼ŒMaven Publishæ’ä»¶å¯ä»¥è‡ªåŠ¨ä¸Šä¼ åç¼€ä¸º"-sources.jar"çš„æºç åŒ…ï¼›å¦‚æœæˆ‘ä»¬ä½¿ç”¨å…¶ä»–ç¼–è¯‘äº§ç‰©å‘å¸ƒè¯­å¥ï¼Œæˆ–è€…å¸Œæœ›æ”¹å˜æºç åŒ…çš„åç§°ã€æ‰“åŒ…å†…å®¹ç­‰ï¼Œå°±è¦è‡ªè¡Œåˆ›å»ºæ‰“åŒ…æºç çš„ä»»åŠ¡ï¼š

"build.gradle":

```groovy
// æ‰“åŒ…æºç çš„ä»»åŠ¡
def sourcesJar = tasks.register('sourcesJar', Jar) {
    // å°†"src/main"ç›®å½•ä¸‹çš„æºç æ–‡ä»¶æ‰“åŒ…
    from sourceSets.main.allJava
    // ä¸ºæºç åŒ…æ·»åŠ åç¼€ä¸ç¨‹åºåŒ…ä½œåŒºåˆ†
    archiveClassifier = 'sources'
}

publishing {
    publications {
        // åˆ›å»ºåä¸º"maven"çš„å‘å¸ƒé…ç½®
        maven(MavenPublication) {
            // æ­¤å¤„çœç•¥å…¶ä»–é…ç½®é¡¹ ...

            // å‘å¸ƒæºç åŒ…
            artifact sourcesJar
        }
    }
}
```

ä¸Šè¿°å†…å®¹ä¹Ÿå¯ä»¥ä½¿ç”¨Kotlinè¯­è¨€ç¼–å†™ï¼š

"build.gradle.kts":

```kotlin
// å‘å¸ƒæºç åŒ…çš„ä»»åŠ¡
val sourcesJar by tasks.creating(Jar::class) {
    // å°†"src/main"ç›®å½•ä¸‹çš„æºç æ–‡ä»¶æ‰“åŒ…
    from(sourceSets.getByName("main").allJava.srcDirs)
    // ä¸ºæºç åŒ…æ·»åŠ åç¼€ä¸ç¨‹åºåŒ…ä½œåŒºåˆ†
    archiveClassifier.set("sources")
}

publishing {
    publications {
        // åˆ›å»ºåä¸º"maven"çš„å‘å¸ƒé…ç½®
        create<MavenPublication>("maven") {
            // æ­¤å¤„çœç•¥å…¶ä»–é…ç½®é¡¹ ...

            // å‘å¸ƒæºç åŒ…
            artifact(sourcesJar)
        }
    }
}
```

åœ¨ä¸Šè¿°ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†åä¸º `sourcesJar` çš„ä»»åŠ¡ä»¥ç”Ÿæˆæºç åŒ…ï¼Œç„¶ååœ¨ `publishing {}` å°èŠ‚ä¸­é€šè¿‡ `artifact()` æ–¹æ³•åº”ç”¨è¯¥ä»»åŠ¡ï¼Œå°†æºç åŒ…ä¹Ÿå‘å¸ƒè‡³ä»“åº“ã€‚

## å‘å¸ƒæ–‡æ¡£åŒ…
Maven Publishæ’ä»¶æ”¯æŒå‘å¸ƒJavaDocæ–‡æ¡£åˆ°Mavenä»“åº“ä¸­ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å®ç°æ­¤åŠŸèƒ½ï¼Œå¯ä»¥åœ¨Gradleé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

"build.gradle":

```groovy
java {
    // ç¼–è¯‘æ¨¡å—æ—¶åŒæ—¶æ‰“åŒ…æ–‡æ¡£
    withJavadocJar()
}

// å¯é€‰é…ç½®ï¼Œæ ¹æ®å®é™…éœ€è¦æ·»åŠ å³å¯ã€‚
javadoc {
    // æŒ‡å®šJavaDocç¼–ç ï¼Œè§£å†³ç³»ç»Ÿç¼–ç ä¸æ–‡ä»¶ä¸ä¸€è‡´å¯¼è‡´é”™è¯¯ã€‚
    options.encoding = 'UTF-8'
}
```

ä¸Šè¿°å†…å®¹ä¹Ÿå¯ä»¥ä½¿ç”¨Kotlinè¯­è¨€ç¼–å†™ï¼š

"build.gradle.kts":

```kotlin
java {
    // ç¼–è¯‘æ¨¡å—æ—¶åŒæ—¶æ‰“åŒ…æ–‡æ¡£
    withJavadocJar()
}

// å¯é€‰é…ç½®ï¼Œæ ¹æ®å®é™…éœ€è¦æ·»åŠ å³å¯ã€‚
tasks.withType<Javadoc> {
    // æŒ‡å®šJavaDocç¼–ç ï¼Œè§£å†³ç³»ç»Ÿç¼–ç ä¸æ–‡ä»¶ä¸ä¸€è‡´å¯¼è‡´é”™è¯¯ã€‚
    options.encoding = "UTF-8"
}
```

## å‘å¸ƒPOMåŒ…
æœ‰äº›æ¨¡å—ä¸­ä¸åŒ…å«ä»»ä½•ç¨‹åºä»£ç ï¼Œåªæœ‰POMæ–‡ä»¶ï¼Œè¿™ç§æ¨¡å—çš„ä½œç”¨æ˜¯èšåˆå¤šä¸ªä¾èµ–é¡¹ï¼Œä½¿ç”¨è€…åªéœ€ä¾èµ–è¯¥æ¨¡å—ï¼Œå°±ä¼šé—´æ¥ä¾èµ–å…¶ä»–ç»„ä»¶ã€‚

ç”±äºæ²¡æœ‰ç¨‹åºä»£ç ï¼Œæˆ‘ä»¬ä¹Ÿä¸éœ€è¦åœ¨å‘å¸ƒé…ç½®ä¸­ä¹¦å†™ `from components.java` è¯­å¥ï¼Œæ­¤æ—¶æ’ä»¶ä¸ä¼šè‡ªåŠ¨åœ¨POMæ–‡ä»¶ä¸­ç”Ÿæˆ `<dependencies/>` èŠ‚ç‚¹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ–°å¢ä¸€äº›é€»è¾‘ä»£ç ï¼Œéå†Gradleçš„ä¾èµ–ç»„ä»¶ï¼Œå°†å…¶è½¬ä¸ºXMLæ ¼å¼å¹¶å†™å…¥POMæ–‡ä»¶ã€‚

"build.gradle":

```groovy
dependencies {
    implementation '<ç»„ä»¶ä¾èµ–é¡¹1>'
    implementation '<ç»„ä»¶ä¾èµ–é¡¹2>'
    implementation '<ç»„ä»¶ä¾èµ–é¡¹N>'
}

publishing {
    publications {
        maven(MavenPublication) {
            // æ­¤å¤„çœç•¥å…¶ä»–é…ç½®é¡¹ ...

            pom.withXml {
                def dependenciesNode = asNode().appendNode('dependencies')
                // è·å–å½“å‰æ¨¡å—çš„æ‰€æœ‰"implementation"èŠ‚ç‚¹
                configurations.implementation.allDependencies.forEach() { Dependency dependency ->
                    def group = dependency.group
                    def artifact = dependency.name
                    def version = dependency.version
                    println("Parse dependency item. Group:[$group] Artifact:[$artifact] Version:[$version]")

                    // å‘POMä¸­æ·»åŠ ä¾èµ–é¡¹ï¼Œå¹¶è·³è¿‡ç»„åä¸ç‰ˆæœ¬å·ä¸ºç©ºçš„é¡¹ã€‚
                    if (group != null && version != null) {
                        def dependencyNode = dependenciesNode.appendNode('dependency')
                        dependencyNode.appendNode('groupId', group)
                        dependencyNode.appendNode('artifactId', artifact)
                        dependencyNode.appendNode('version', version)
                        dependencyNode.appendNode('scope', 'compile')
                    }
                }
            }
        }
    }
}
```

ä¸Šè¿°å†…å®¹ä¹Ÿå¯ä»¥ä½¿ç”¨Kotlinè¯­è¨€ç¼–å†™ï¼š

"build.gradle.kts":

```kotlin
dependencies {
    implementation("<ç»„ä»¶ä¾èµ–é¡¹1>")
    implementation("<ç»„ä»¶ä¾èµ–é¡¹2>")
    implementation("<ç»„ä»¶ä¾èµ–é¡¹N>")
}

publishing {
    publications {
        create<MavenPublication>("maven") {
            // æ­¤å¤„çœç•¥å…¶ä»–é…ç½®é¡¹ ...

            pom.withXml {
                val dependenciesNode = asNode().appendNode("dependencies")
                // è·å–å½“å‰æ¨¡å—çš„æ‰€æœ‰"implementation"èŠ‚ç‚¹
                configurations.getByName("implementation").allDependencies.forEach { dependency ->
                    val group: String? = dependency.group
                    val artifact: String = dependency.name
                    val version: String? = dependency.version
                    println("Parse dependency item. Group:[$group] Artifact:[$artifact] Version:[$version]")

                    // å‘POMä¸­æ·»åŠ ä¾èµ–é¡¹ï¼Œå¹¶è·³è¿‡ç»„åä¸ç‰ˆæœ¬å·ä¸ºç©ºçš„é¡¹ã€‚
                    if (group != null && version != null) {
                        val dependencyNode = dependenciesNode.appendNode("dependency")
                        dependencyNode.appendNode("groupId", group)
                        dependencyNode.appendNode("artifactId", artifact)
                        dependencyNode.appendNode("version", version)
                        dependencyNode.appendNode("scope", "compile")
                    }
                }
            }
        }
    }
}
```

## è°ƒæ•´æ¨¡å—å‘å¸ƒé¡ºåº
### ç®€ä»‹
éƒ¨åˆ†æ¨¡å—ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œä¾‹å¦‚æ¨¡å— `ModuleA` ä¾èµ–è¿œç¨‹ä»“åº“ä¸­çš„æ¨¡å— `ModuleB` ï¼Œå½“æˆ‘ä»¬å°†ä¸¤ä¸ªæ¨¡å—éƒ½å‡çº§åˆ°æ–°çš„ç‰ˆæœ¬åï¼Œæ‰§è¡Œæ•´ä¸ªå·¥ç¨‹çš„å‘å¸ƒä»»åŠ¡å°±æœ‰å¯èƒ½é‡åˆ°é”™è¯¯ï¼›è¿™æ˜¯å› ä¸ºGradleä¼šå¹¶è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœ `ModuleA` çš„å‘å¸ƒä»»åŠ¡é¦–å…ˆè¢«æ‰§è¡Œï¼Œæ­¤æ—¶ `ModuleB` çš„æ–°ç‰ˆæœ¬è¿˜æ²¡æœ‰è¢«å‘å¸ƒåˆ°è¿œç¨‹ä»“åº“ï¼Œ `ModuleA` å°±ä¼šå› ç¼ºå°‘ä¾èµ–ç»„ä»¶è€Œç¼–è¯‘å¤±è´¥ã€‚

ä¸‹æ–‡ç« èŠ‚æä¾›äº†ä¸€äº›è°ƒæ•´Gradleä»»åŠ¡æ‰§è¡Œé¡ºåºçš„æ–¹æ³•ï¼Œå®ƒä»¬å…·æœ‰ä¸åŒçš„é€‚ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©ã€‚

### æŒ‡å®šä»»åŠ¡æ‰§è¡Œé¡ºåº
æˆ‘ä»¬å¯ä»¥åœ¨æ¨¡å— `ModuleA` çš„Gradleé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹è¯­å¥ï¼Œè·å–æ¨¡å— `ModuleA` çš„"publish"ä»»åŠ¡ï¼Œç„¶åæŒ‡å®šè¯¥ä»»åŠ¡å¿…é¡»åœ¨å®ƒæ‰€ä¾èµ–çš„æ¨¡å— `ModuleB` å‘å¸ƒå®Œæˆä¹‹åå†æ‰§è¡Œã€‚

"build.gradle":

```groovy
task(":publish") {
    dependsOn ':ModuleB:publish'
    mustRunAfter ':ModuleB:publish'
}
```

ä¸Šè¿°å†…å®¹ä¹Ÿå¯ä»¥ä½¿ç”¨Kotlinè¯­è¨€ç¼–å†™ï¼š

"build.gradle.kts":

```kotlin
tasks.named("publish") {
    dependsOn(":ModuleB:publish")
    mustRunAfter(":ModuleB:publish")
}
```

`dependsOn()` æ–¹æ³•æŒ‡å®šäº†æ‰§è¡Œæ¨¡å— `ModuleA` çš„"publish"ä»»åŠ¡æ—¶éœ€è¦åŒæ—¶æ‰§è¡Œæ¨¡å— `ModuleB` çš„"publish"ä»»åŠ¡ï¼Œæ­¤æ—¶ä¸¤ä¸ªæ¨¡å—çš„"publish"ä»»åŠ¡å·²ç»äº§ç”Ÿäº†å…³è”ï¼Œä½†å®ƒä»¬ä»ç„¶ä¼šå¹¶å‘æ‰§è¡Œã€‚æˆ‘ä»¬è¿˜éœ€è¦è°ƒç”¨ `mustRunAfter()` æ–¹æ³•ï¼ŒæŒ‡å®šæ¨¡å— `ModuleA` çš„"publish"ä»»åŠ¡åœ¨æ¨¡å— `ModuleB` çš„"publish"ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åå†å¼€å§‹æ‰§è¡Œã€‚

è¿™ç§æ–¹å¼ä½¿ç”¨äº†Gradleè‡ªèº«æä¾›çš„èƒ½åŠ›ï¼Œä¾µå…¥æ€§è¾ƒä½ï¼Œä½†æ˜¯ä½œç”¨èŒƒå›´ä»…é™å½“å‰å·¥ç¨‹ï¼Œæ— æ³•æ§åˆ¶è·¨å·¥ç¨‹ä»»åŠ¡çš„é¡ºåºã€‚

### æ‰‹åŠ¨å¡«å†™ä¾èµ–ä¿¡æ¯
æˆ‘ä»¬å¯ä»¥åœ¨æ¨¡å— `ModuleA` çš„Gradleé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹è¯­å¥ï¼Œå°†æ¨¡å— `ModuleB` çš„è¿œç¨‹ä»“åº“ä¾èµ–å£°æ˜æ”¹ä¸ºæœ¬åœ°å·¥ç¨‹ä¾èµ–å£°æ˜ï¼Œæ­¤æ—¶æ¨¡å— `ModuleA` å¯ä»¥ç›´æ¥å¼•ç”¨æ¨¡å— `ModuleB` ä¸­çš„ä»£ç é€šè¿‡ç¼–è¯‘ã€‚

"build.gradle":

```groovy
dependencies {
    // å°†è¿œç¨‹ä»“åº“ä¾èµ–æ›¿æ¢ä¸ºæœ¬åœ°å·¥ç¨‹ä¾èµ–
    // implementation '<Group>:ModuleB:1.0'
    implementation project(':ModuleB')
}

publishing {
    publications {
        maven(MavenPublication) {
            // æ­¤å¤„çœç•¥å…¶ä»–é…ç½®é¡¹ ...

            pom.withXml {
                def group = '<ç»„åç§°>'
                def artifact = '<äº§ç‰©åç§°>'
                def version = '<ç‰ˆæœ¬å·>'

                def dependenciesNode = asNode().appendNode('dependencies')
                def dependencyNode = dependenciesNode.appendNode('dependency')
                dependencyNode.appendNode('groupId', group)
                dependencyNode.appendNode('artifactId', artifact)
                dependencyNode.appendNode('version', version)
            }
        }
    }
}
```

ä¸Šè¿°å†…å®¹ä¹Ÿå¯ä»¥ä½¿ç”¨Kotlinè¯­è¨€ç¼–å†™ï¼š

"build.gradle.kts":

```kotlin
dependencies {
    // å°†è¿œç¨‹ä»“åº“ä¾èµ–æ›¿æ¢ä¸ºæœ¬åœ°å·¥ç¨‹ä¾èµ–
    // implementation("<Mavenä»“åº“è·¯å¾„>:ModuleB:1.0")
    implementation(project(":ModuleB"))
}

publishing {
    publications {
        create<MavenPublication>("maven") {
            // æ­¤å¤„çœç•¥å…¶ä»–é…ç½®é¡¹ ...

            pom.withXml {
                val group: String = "<ç»„åç§°>"
                val artifact: String = "<äº§ç‰©åç§°>"
                val version: String = "<ç‰ˆæœ¬å·>"

                val dependenciesNode = asNode().appendNode("dependencies")
                val dependencyNode = dependenciesNode.appendNode("dependency")
                dependencyNode.appendNode("groupId", group)
                dependencyNode.appendNode("artifactId", artifact)
                dependencyNode.appendNode("version", version)
            }
        }
    }
}
```

ç”±äºMaven Publishæ’ä»¶ä¸ä¼šå°†æœ¬åœ°å·¥ç¨‹ä¾èµ–ä¿¡æ¯å†™å…¥POMæ–‡ä»¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‰‹åŠ¨æ·»åŠ æ¨¡å— `ModuleB` çš„ä¾èµ–ä¿¡æ¯ã€‚

è¿™ç§æ–¹å¼éœ€è¦æ‰‹åŠ¨ç®¡ç†ä¾èµ–ä¿¡æ¯ï¼Œè¾ƒä¸ºç¹çä¸”å®¹æ˜“å‡ºç°é”™æ¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä»–æ–¹æ³•å¤±æ•ˆæ—¶ä½¿ç”¨å®ƒã€‚

### é€šè¿‡ç¼–è¯‘è„šæœ¬æ§åˆ¶
å¦‚æœæ•´ä¸ªå·¥ç¨‹ç”±å¤šä¸ªå­å·¥ç¨‹ç»„æˆï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Bashã€Pythonç­‰è„šæœ¬æ§åˆ¶å„ä¸ªå­å·¥ç¨‹çš„ç¼–è¯‘é¡ºåºï¼Œé¢„å…ˆç¼–è¯‘å¹¶å‘å¸ƒè¢«å…¶ä»–æ¨¡å—æ‰€ä¾èµ–çš„åŸºç¡€æ¨¡å—ã€‚

è¿™ç§æ–¹å¼éœ€è¦ç¼–å†™é¢å¤–çš„ç¼–è¯‘è„šæœ¬ï¼Œä½†èƒ½å¤Ÿè§£å†³è·¨å·¥ç¨‹çš„ç¼–è¯‘é¡ºåºé—®é¢˜ï¼Œæ¯”è¾ƒé€‚åˆåœ¨è§„æ¨¡è¾ƒå¤§çš„å¤šæ¨¡å—å·¥ç¨‹ä¸­ä½¿ç”¨ã€‚
