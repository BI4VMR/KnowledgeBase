# 概述
最早的以太网将局域网内的计算机都连接到一根总线上，当一台计算机发送数据帧时，总线上的所有计算机都能接收到这个数据帧，计算机收到帧后检查目的物理地址，只有自身的物理地址与其相同时，才接收数据帧并交由上层协议处理，否则丢弃该帧。

# CSMA/CD协议
## 简介
在共享式以太网中，双向的传输是在同一线路上进行的，所以同一时间只能有一面的信号在线路上，即要么A往B发；要么B往A发，如果AB同时发送数据或者线路上已有其它信号，那么信号就会发生碰撞并产生冲突碎片，影响数据的有效传输。

载波监听多路访问/冲突检测(Carrier Sense Multiple Access/Collision Detection, CSMA/CD)协议，是一种争用型介质访问控制协议，工作在数据链路层，主要解决在共享介质上以泛洪方式传送数据时可能出现的数据碰撞问题。

## 特点
CSMA/CD协议的原理比较简单，技术上容易实现，网络中各工作站处于平等地位，无需集中控制。

当网络负载增大时，发生冲突的概率急剧增加，将会导致等待时间增长，通信效率急剧下降。

## 工作原理
一个站点发送数据前先侦听信道是否空闲，若空闲，则立即发送数据。若信道忙碌，则等待一段时间至信道中的信息传输结束后再发送数据；发送数据的同时侦听信道，一旦检测到同时有两个或多个节点同时发送数据，则判定为冲突，然后立即停止发送数据，等待一段随机时间，再重新尝试发送。

其原理可以简单地总结为：先听后发，边发边听，冲突停发，随机重发。

## 退避算法
当出现线路冲突时，如果各站点都采用同样的退避时间，则重发时很容易产生二次、三次的碰撞。因此各个站点的退避时间要有差异，通常通过以下退避算法来实现。

🔷 非坚持型CSMA

若线路忙，等待一段时间，再侦听；不忙时，立即发送。

这种方式信道利用率最低，但能够减少冲突概率。

🔷 1坚持型CSMA

若线路忙，继续侦听；不忙时，立即发送。

这种方式信道利用率最高，但造成冲突的概率最大。

🔷 p坚持型CSMA

若线路忙，继续侦听；不忙时，根据概率 $p$ 进行发送，而另外的 $(1-p)$ 概率则继续侦听。

这种方式平衡了上述两种机制的特点，但实现较为复杂，概率"p"的确定需要具体实验才能得出。

## 争用期
以太网的端到端往返时延称为争用期，或碰撞窗口。

在极限条件下，一个局域网中两个收发器间（允许接4个中继器）的最大距离为2500m，往返距离为5000m，同轴电缆的时延特性为5μs/km，即如遇冲突，端到端往返时延为25μs。然而这是理想的时延，考虑到中继器的额外时延，最坏情况下取估计时延为45μs，再加上冲突告警数据为48bit，接收方需要收到48bit数据后才能确认冲突，需要再增加4.8μs。以上时长共计49.8μs，所以以太网取整数51.2μs为争用期（传输512bit/64字节所用的时间），即帧的长度至少为64字节。

100Mbps以太网的时隙仍为512位时；1000Mbps以太网的时隙增至512字节，即4096位时，4.096μs。

# 最小帧长
按照标准，10Mbps以太网采用中继器时，连接的最大长度是2500米，最多经过4个中继器，因此规定对10Mbps以太网一帧的最小发送时间为51.2微秒。这段时间所能传输的数据为512位，因此也称该时间为512位时。这个时间定义为以太网时隙，或冲突时槽。512位=64字节，这就是以太网帧最小64字节的原因。

# 最大帧长
在总线型以太网中，为了避免单个节点长时间占用信道，最大帧长限制为1500字节。

# 中继器
中继器(Repeater)工作在ISO/OSI参考模型的物理层，是最简单的网络设备。

由于线缆上存在传输损耗，信号功率会逐渐衰减，衰减到一定程度时信号将会失真，使得接收端无法辨识。中继器就是用来解决这一问题的，它从接收端口收到信号后将比特流按位复制、放大并整型，再从发送端口送出，以此来延长通信距离。

<div align="center">

![双绞线中继器](./Assets-共享式以太网/中继器-双绞线中继器.jpg)

</div>

# 集线器
集线器(Hub)的主要功能是对接收到的信号进行再生整形放大，工作在半双工状态。

集线器工作在ISO/OSI参考模型的物理层，采用CSMA/CD机制，当它收到数据包时，将会采用广播方式把数据包发送到所有其他接口。

<div align="center">

![集线器的工作方式](./Assets-共享式以太网/集线器-集线器的工作方式.jpg)

</div>

由于所有连到集线器的设备，都属于同一个冲突域以及广播域，不同信号碰撞的概率很大，并且信号也可能被窃听，因此集线器已被交换机取代。
