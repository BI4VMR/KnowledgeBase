# 概述
静态路由条目由管理员手动配置，如果网络中设备较多，需要配置的条目数量将以几何倍数增长，并且容易发生错误。

对于规模较大、拓扑复杂、变更频繁的网络，我们需要使用动态路由协议管理路由表。路由器之间通过动态路由协议进行报文交互，互相学习了解前往其它网络的路由信息，并选出最佳路径。

# 术语
## 自治系统
自治系统(Autonomous System, AS)是由单一组织管理的一组设备集合，自治系统有时也被称为路由选择域(Routing Domain)。Internet由多个AS互联组成，每个AS由一个2字节的数字进行标识，我们把这个数字叫做自治系统号(ASN)，每个组织需要在其所属区域的互联网管理机构申请ASN，然后就可以与其他AS交换公网路由信息了。

## 域内路由协议
域内路由协议(Interior Gateway Protocol, IGP)，负责维护自治系统内部的路由信息。

IGP主要用于同一AS域内的路由信息交换，度量规则较为单一，配置也较为简单。

## 域间路由协议
域间路由协议(Exterior Gateway Protocol, EGP)，负责在自治系统之间交换路由信息。

EGP主要用于在AS之间传递Internet公网路由，因此选路规则更为丰富，配置也较为复杂。

## 路由宣告
当管理员将路由器接口加入路由协议进程后，接口就会参与该协议的报文收发工作，对外通告接口所在的网络信息，这一过程被称为“路由宣告”。

## 路由收敛
当网络拓扑发生变化时，所有节点的路由表进行同步的过程，被称为路由收敛(Convergence)。

$$
收敛时间=检测到拓扑变更的时间+信息传递时间+其他节点计算路由的时间
$$

# 协议类型
## 距离矢量路由协议
距离矢量协议采用距离矢量(Distance-Vector, DV)算法，依据传闻进行路由选择。

相邻的路由器之间互相交换整个路由表，并进行矢量的叠加，最后学习到整个网络的路由表。收敛完成时每个路由器都拥有完整的全网路由表。

距离矢量路由协议有以下特点：

🔷 可靠性较低

基于邻居路由器发送的报文学习路由信息，可靠性不高，可能会产生环路。

🔷 收敛速度较慢

路由器通过定期发送自身路由表同步全网路由，对于规模较大的网络收敛很慢，且不利于管理与维护。

## 链路状态路由协议
链路状态协议采用链路状态(Link State, LS)算法，每个路由器都从其他节点获取链路信息，建立一张完整的网络拓扑视图，然后计算出到达各网段的最佳路径。

链路状态协议是层次化的，路由器并不会简单的从邻居节点直接学习路由信息，而是把管理域划分为若干较小的区域，并收集区域内所有的链路状态信息，然后利用这些信息建立网络拓扑图，再根据拓扑结构计算到达各处的路由信息。

在链路状态路由协议中，每台路由器都了解所属区域的网络拓扑信息，转发数据包时可以做出更精确的转发决策，且区域内不会出现环路。

链路状态协议的工作流程：

1. 各节点与相邻节点建立邻居关系。
2. 各节点之间交换链路状态数据包(LSP)，同步区域链路状态。
3. 各节点将链路状态保存在自身的链路状态数据库中。
4. 各节点依照链路状态数据库计算到每个网络的最短路径。
